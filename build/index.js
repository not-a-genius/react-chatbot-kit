(()=>{"use strict";var e={n:t=>{var r=t&&t.__esModule?()=>t.default:()=>t;return e.d(r,{a:r}),r},d:(t,r)=>{for(var a in r)e.o(r,a)&&!e.o(t,a)&&Object.defineProperty(t,a,{enumerable:!0,get:r[a]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Chatbot:()=>q,createChatBotMessage:()=>i,createClientMessage:()=>u,createCustomMessage:()=>l,default:()=>V,useChatbot:()=>D});const r=require("react");var a=e.n(r);const n=require("react-conditionally-render");var o=e.n(n),s=function(){return s=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},s.apply(this,arguments)},c=function(e,t){return{message:e,type:t,id:Math.round(Date.now()*Math.random())}},i=function(e,t,r){return s(s(s(s({},c(e,"bot")),{isFixedMessage:r}),t),{loading:!0})},l=function(e,t,r){return s(s({},c(e,t)),r)},u=function(e,t){return s(s({},c(e,"user")),t)},m=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e)return e.apply(void 0,t)};function d(){return d=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},d.apply(this,arguments)}const g=({styles:e={},...t})=>a().createElement("svg",d({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512"},t),a().createElement("path",{d:"M256 288c79.5 0 144-64.5 144-144S335.5 0 256 0 112 64.5 112 144s64.5 144 144 144zm128 32h-55.1c-22.2 10.2-46.9 16-72.9 16s-50.6-5.8-72.9-16H128C57.3 320 0 377.3 0 448v16c0 26.5 21.5 48 48 48h416c26.5 0 48-21.5 48-48v-16c0-70.7-57.3-128-128-128z"})),h=function(e){var t=e.message,r=e.customComponents;return a().createElement("div",{className:"react-chatbot-kit-user-chat-message-container"},a().createElement(o(),{condition:!!r.userChatMessage,show:m(r.userChatMessage,{message:t}),elseShow:a().createElement("div",{className:"react-chatbot-kit-user-chat-message"},t,a().createElement("div",{className:"react-chatbot-kit-user-chat-message-arrow"}))}),a().createElement(o(),{condition:!!r.userAvatar,show:m(r.userAvatar),elseShow:a().createElement("div",{className:"react-chatbot-kit-user-avatar"},a().createElement("div",{className:"react-chatbot-kit-user-avatar-container"},a().createElement(g,{className:"react-chatbot-kit-user-avatar-icon"})))}))},f=function(){return a().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar"},a().createElement("div",{className:"react-chatbot-kit-chat-bot-avatar-container"},a().createElement("p",{className:"react-chatbot-kit-chat-bot-avatar-letter"},"B")))},p=function(){return a().createElement("div",{className:"chatbot-loader-container"},a().createElement("svg",{id:"dots",width:"50px",height:"21px",viewBox:"0 0 132 58",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},a().createElement("g",{stroke:"none",fill:"none"},a().createElement("g",{id:"chatbot-loader",fill:"#fff"},a().createElement("circle",{id:"chatbot-loader-dot1",cx:"25",cy:"30",r:"13"}),a().createElement("circle",{id:"chatbot-loader-dot2",cx:"65",cy:"30",r:"13"}),a().createElement("circle",{id:"chatbot-loader-dot3",cx:"105",cy:"30",r:"13"})))))},v=require("@mui/material/IconButton");var b=e.n(v);const y=require("@mui/icons-material/ThumbUp");var w=e.n(y);const E=require("@mui/icons-material/ThumbDown");var k=e.n(E);const S=require("@mui/material"),C=require("axios");var M=e.n(C),P=function(){return P=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},P.apply(this,arguments)};const T=function(e){var t=e.message,n=e.withAvatar,s=void 0===n||n,c=e.loading,i=e.messages,l=e.customComponents,u=e.setState,d=e.customStyles,g=e.delay,h=e.id,v=e.onThumbUpClick,y=e.onThumbDownClick,E=e.isFixedMessage,C=e.beUserMessageId,T=e.beBotMessageId,O=e.chatSessionId,x=e.patchUrl,I=(0,r.useState)(!1),N=I[0],j=I[1],U=(0,r.useState)(!1),B=U[0],A=U[1],H=(0,r.useState)(!1),R=H[0],W=H[1],_=(0,r.useState)(0),D=_[0],F=_[1],q=(0,r.useState)(T),V=q[0],z=q[1];(0,r.useEffect)((function(){var e;return function(t,r){var a=750;g&&(a+=g),e=setTimeout((function(){var e=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))}([],t,!0).find((function(e){return e.id===h}));e&&(e.loading=!1,e.delay=void 0,r((function(t){var r=t.messages,a=r.findIndex((function(e){return e.id===h}));return r[a]=e,P(P({},t),{messages:r})})))}),a)}(i,u),function(){clearTimeout(e)}}),[g,h]),(0,r.useEffect)((function(){g?setTimeout((function(){return j(!0)}),g):j(!0)}),[g]);var L={backgroundColor:""},G={borderRightColor:""};d&&(L.backgroundColor=d.backgroundColor,G.borderRightColor=d.backgroundColor);var J=function(e,r){return a=void 0,n=void 0,s=function(){var a,n,o;return function(e,t){var r,a,n,o,s={label:0,sent:function(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return o={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function c(o){return function(c){return function(o){if(r)throw new TypeError("Generator is already executing.");for(;s;)try{if(r=1,a&&(n=2&o[0]?a.return:o[0]?a.throw||((n=a.return)&&n.call(a),0):a.next)&&!(n=n.call(a,o[1])).done)return n;switch(a=0,n&&(o=[2&o[0],n.value]),o[0]){case 0:case 1:n=o;break;case 4:return s.label++,{value:o[1],done:!1};case 5:s.label++,a=o[1],o=[0];continue;case 7:o=s.ops.pop(),s.trys.pop();continue;default:if(!((n=(n=s.trys).length>0&&n[n.length-1])||6!==o[0]&&2!==o[0])){s=0;continue}if(3===o[0]&&(!n||o[1]>n[0]&&o[1]<n[3])){s.label=o[1];break}if(6===o[0]&&s.label<n[1]){s.label=n[1],n=o;break}if(n&&s.label<n[2]){s.label=n[2],s.ops.push(o);break}n[2]&&s.ops.pop(),s.trys.pop();continue}o=t.call(e,s)}catch(e){o=[6,e],a=0}finally{r=n=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,c])}}}(this,(function(s){switch(s.label){case 0:console.log("postBotMessageThumb called"),console.log("url:",e),console.log("thumbsUp:",r),console.log("beBotMessageId:",V),console.log("beUserMessageId:",C),console.log("chatSessionId:",O),s.label=1;case 1:return s.trys.push([1,6,,7]),a={user_message_id:C,chat_id:O,content:t,bot_message_id:V,thumbsUp:r},void 0!==V?[3,3]:[4,M().post(e,a).then((function(t){z(t.data.bot_message_id),console.log("Send successfully post data to:",e,t.data)}))];case 2:return s.sent(),[3,5];case 3:return[4,M().patch(e,a)];case 4:n=s.sent(),console.log("Send successfully patch data to:",e,n.data),s.label=5;case 5:return[3,7];case 6:return o=s.sent(),console.error("Error in postBotMessageThumb to:",e,o.message),[3,7];case 7:return[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function c(e){try{i(s.throw(e))}catch(e){t(e)}}function i(t){var a;t.done?e(t.value):(a=t.value,a instanceof o?a:new o((function(e){e(a)}))).then(r,c)}i((s=s.apply(a,n||[])).next())}));var a,n,o,s};return(0,r.useEffect)((function(){B?(J(x,!0),v&&v()):R?(J(x,!1),y&&y()):D>0&&!B&&!R&&J(x,null)}),[B,R]),a().createElement(o(),{condition:N,show:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message-container"},a().createElement(o(),{condition:s,show:a().createElement(o(),{condition:!!(null==l?void 0:l.botAvatar),show:m(null==l?void 0:l.botAvatar),elseShow:a().createElement(f,null)})}),a().createElement(o(),{condition:!!(null==l?void 0:l.botChatMessage),show:m(null==l?void 0:l.botChatMessage,{message:t,loader:a().createElement(p,null)}),elseShow:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message",style:L},a().createElement(o(),{condition:c,show:a().createElement(p,null),elseShow:a().createElement("span",null,t)}),a().createElement(o(),{condition:s,show:a().createElement("div",{className:"react-chatbot-kit-chat-bot-message-arrow",style:G})}))}),E?"":a().createElement(S.Stack,{className:"thumbsContainer"},a().createElement(b(),{onClick:function(){F(D+1),A(!B),W(!1)}},a().createElement(w(),{style:{fill:"cyan"},sx:{stroke:B?"#3d4e8d":"black",strokeWidth:B?2:1}})),a().createElement(b(),{onClick:function(){F(D+1),W(!R),A(!1),J(x,!R&&null)}},a().createElement(k(),{style:{fill:"darkgrey"},sx:{stroke:R?"#3d4e8d":"black",strokeWidth:R?2:1}}))))})},O=require("@mui/icons-material/SendRounded");var x=e.n(O),I=function(){return I=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},I.apply(this,arguments)},N=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))};const j=function(e){var t=e.state,n=e.setState,s=e.widgetRegistry,i=e.messageParser,l=e.parse,u=e.customComponents,m=e.actionProvider,d=e.botName,g=e.customStyles,f=e.headerText,p=e.customMessages,v=e.placeholderText,b=e.validator,y=e.setMessageContainerRef,w=e.disableScrollToBottom,E=e.messageHistory,k=e.actions,S=e.onThumbUpClick,C=e.onThumbDownClick,M=e.patchUrl,P=e.chatSessionId,O=e.beUserMessageId,j=t.messages,U=(0,r.useRef)(null),B=(0,r.useState)(""),A=B[0],H=B[1],R=function(){setTimeout((function(){var e;U.current&&(U.current.scrollTop=null===(e=null==U?void 0:U.current)||void 0===e?void 0:e.scrollHeight)}),50)};(0,r.useEffect)((function(){w||R()})),(0,r.useEffect)((function(){y(U)}),[U.current]);var W=function(){n((function(e){return I(I({},e),{messages:N(N([],e.messages,!0),[c(A,"user")],!1)})})),R(),H("")},_={backgroundColor:""};g&&g.chatButton&&(_.backgroundColor=g.chatButton.backgroundColor);var D="Conversation with "+d;f&&(D=f);var F="Write your message here";return v&&(F=v),a().createElement("div",{className:"react-chatbot-kit-chat-container"},a().createElement("div",{className:"react-chatbot-kit-chat-inner-container"},a().createElement(o(),{condition:!!u.header,show:u.header&&u.header(m),elseShow:a().createElement("div",{className:"react-chatbot-kit-chat-header"},D)}),a().createElement("div",{className:"react-chatbot-kit-chat-message-container",ref:U},a().createElement(o(),{condition:"string"==typeof E&&Boolean(E),show:a().createElement("div",{dangerouslySetInnerHTML:{__html:E}})}),j.map((function(e,r){return"bot"===e.type?a().createElement(a().Fragment,{key:e.id},function(e,r){var c;c=e.withAvatar?e.withAvatar:function(e,t){if(0===t)return!0;var r=e[t-1];return!("bot"===r.type&&!r.widget)}(j,r);var i=I(I({},e),{setState:n,state:t,customComponents:u,widgetRegistry:s,messages:j,actions:k,onThumbUpClick:S,onThumbDownClick:C});if(e.widget){var l=s.getWidget(i.widget,I(I({},t),{scrollIntoView:R,payload:e.payload,actions:k}));return a().createElement(a().Fragment,null,a().createElement(T,I({customStyles:g.botMessageBox,withAvatar:c},i,{key:e.id,onThumbUpClick:S,onThumbDownClick:C,patchUrl:M,chatSessionId:P,beUserMessageId:O})),a().createElement(o(),{condition:!i.loading,show:l||null}))}return a().createElement(T,I({customStyles:g.botMessageBox,key:e.id,withAvatar:c},i,{customComponents:u,messages:j,setState:n,onThumbUpClick:S,onThumbDownClick:C,isFixedMessage:e.isFixedMessage,patchUrl:M,beUserMessageId:e.beUserMessageId,chatSessionId:P}))}(e,r)):"user"===e.type?a().createElement(a().Fragment,{key:e.id},function(e){var r=s.getWidget(e.widget,I(I({},t),{scrollIntoView:R,payload:e.payload,actions:k}));return a().createElement(a().Fragment,null,a().createElement(h,{message:e.message,key:e.id,customComponents:u}),r||null)}(e)):function(e,t){return!!t[e.type]}(e,p)?a().createElement(a().Fragment,{key:e.id},function(e){var r=p[e.type],o={setState:n,state:t,scrollIntoView:R,actionProvider:m,payload:e.payload,actions:k};if(e.widget){var c=s.getWidget(e.widget,I(I({},t),{scrollIntoView:R,payload:e.payload,actions:k}));return a().createElement(a().Fragment,null,r(o),c||null)}return r(o)}(e)):void 0})),a().createElement("div",{style:{paddingBottom:"15px"}})),a().createElement("div",{className:"react-chatbot-kit-chat-input-container"},a().createElement("form",{className:"react-chatbot-kit-chat-input-form",onSubmit:function(e){if(e.preventDefault(),b&&"function"==typeof b){if(b(A)){if(W(),l)return l(A);i.parse(A)}}else{if(W(),l)return l(A);i.parse(A)}}},a().createElement("input",{className:"react-chatbot-kit-chat-input",placeholder:F,value:A,onChange:function(e){return H(e.target.value)}}),a().createElement("button",{className:"react-chatbot-kit-chat-btn-send",style:_},a().createElement(x(),{className:"react-chatbot-kit-chat-btn-send-icon"}))))))},U=function(e){var t=e.message;return a().createElement("div",{className:"react-chatbot-kit-error"},a().createElement("h1",{className:"react-chatbot-kit-error-header"},"Ooops. Something is missing."),a().createElement("div",{className:"react-chatbot-kit-error-container"},a().createElement(T,{message:t,withAvatar:!0,loading:!1,id:1,customStyles:{backgroundColor:""},messages:[]})),a().createElement("a",{href:"https://fredrikoseberg.github.io/react-chatbot-kit-docs/",rel:"noopener norefferer",target:"_blank",className:"react-chatbot-kit-error-docs"},"View the docs"))};var B=function(e){return e.widgets?e.widgets:[]},A=function(e){try{new e}catch(e){return!1}return!0},H=function(){return H=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},H.apply(this,arguments)};const R=function(e,t){var r=this;this.addWidget=function(e,t){var a=e.widgetName,n=e.widgetFunc,o=e.mapStateToProps,s=e.props;r[a]={widget:n,props:s,mapStateToProps:o,parentProps:H({},t)}},this.getWidget=function(e,t){var a=r[e];if(a){var n,o=H(H(H(H({scrollIntoView:t.scrollIntoView},a.parentProps),"object"==typeof(n=a.props)?n:{}),r.mapStateToProps(a.mapStateToProps,t)),{setState:r.setState,actionProvider:r.actionProvider||t.actions,actions:t.actions,state:t,payload:t.payload});return a.widget(o)||null}},this.mapStateToProps=function(e,t){if(e)return e.reduce((function(e,r){return e[r]=t[r],e}),{})},this.setState=e,this.actionProvider=t};var W=function(){return W=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},W.apply(this,arguments)},_=function(e,t,r){if(r||2===arguments.length)for(var a,n=0,o=t.length;n<o;n++)!a&&n in t||(a||(a=Array.prototype.slice.call(t,0,n)),a[n]=t[n]);return e.concat(a||Array.prototype.slice.call(t))};const D=function(e){var t=e.config,n=e.actionProvider,o=e.messageParser,s=e.messageHistory,c=e.runInitialMessagesWithHistory,m=e.saveMessages,d=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(e,["config","actionProvider","messageParser","messageHistory","runInitialMessagesWithHistory","saveMessages"]),g="",h="";if(!t||!n||!o)return{configurationError:g="I think you forgot to feed me some props. Did you remember to pass a config, a messageparser and an actionprovider?"};var f=function(e,t){var r=[];return e.initialMessages||r.push("Config must contain property 'initialMessages', and it expects it to be an array of chatbotmessages."),r}(t);if(f.length)return{invalidPropsError:h=f.reduce((function(e,t){return e+t}),"")};var p=(0,r.useState)({}),v=p[0],b=p[1],y=function(e){return e.state?e.state:{}}(t);s&&Array.isArray(s)?t.initialMessages=_([],s,!0):"string"==typeof s&&Boolean(s)&&(c||(t.initialMessages=[]));var w,E,k,S=a().useState(W({messages:_([],t.initialMessages,!0)},y)),C=S[0],M=S[1],P=a().useRef(C.messages),T=a().useRef();(0,r.useEffect)((function(){P.current=C.messages})),(0,r.useEffect)((function(){s&&Array.isArray(s)&&M((function(e){return W(W({},e),{messages:s})}))}),[]),(0,r.useEffect)((function(){return function(){var e;if(m&&"function"==typeof m){var t=null===(e=null==v?void 0:v.current)||void 0===e?void 0:e.innerHTML.toString();if(!v.current)return;m(P.current,t)}}}),[v.current]),(0,r.useEffect)((function(){T.current=C}),[C]);var O=n,x=o;return A(O)&&A(x)?(w=new n(i,M,u,T.current,l,d),E=new R(M,w),k=new o(w,T.current),B(t).forEach((function(e){return null==E?void 0:E.addWidget(e,d)}))):(w=n,k=o,E=new R(M,null),B(t).forEach((function(e){return null==E?void 0:E.addWidget(e,d)}))),{widgetRegistry:E,actionProv:w,messagePars:k,configurationError:g,invalidPropsError:h,state:C,setState:M,setMessageContainerRef:b,ActionProvider:O,MessageParser:x}};var F=function(){return F=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},F.apply(this,arguments)};const q=function(e){var t=e.actionProvider,r=e.messageParser,n=e.config,o=e.headerText,s=e.placeholderText,c=e.saveMessages,l=e.messageHistory,u=e.runInitialMessagesWithHistory,m=e.disableScrollToBottom,d=e.validator,g=e.onThumbUpClick,h=e.onThumbDownClick,f=e.chatSessionId,p=e.patchUrl,v=function(e,t){var r={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(r[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(r[a[n]]=e[a[n]])}return r}(e,["actionProvider","messageParser","config","headerText","placeholderText","saveMessages","messageHistory","runInitialMessagesWithHistory","disableScrollToBottom","validator","onThumbUpClick","onThumbDownClick","chatSessionId","patchUrl"]),b=D(F({config:n,actionProvider:t,messageParser:r,messageHistory:l,saveMessages:c,runInitialMessagesWithHistory:u},v)),y=b.configurationError,w=b.invalidPropsError,E=b.ActionProvider,k=b.MessageParser,S=b.widgetRegistry,C=b.actionProv,M=b.messagePars,P=b.state,T=b.setState,O=b.setMessageContainerRef;if(y)return a().createElement(U,{message:y});if(w.length)return a().createElement(U,{message:w});var x=function(e){return e.customStyles?e.customStyles:{}}(n),I=function(e){return e.customComponents?e.customComponents:{}}(n),N=function(e){return e.botName?e.botName:"Bot"}(n),B=function(e){return e.customMessages?e.customMessages:{}}(n);return A(E)&&A(k)?a().createElement(j,{state:P,setState:T,widgetRegistry:S,actionProvider:C,messageParser:M,customMessages:B,customComponents:F({},I),botName:N,customStyles:F({},x),headerText:o,placeholderText:s,setMessageContainerRef:O,validator:d,messageHistory:l,disableScrollToBottom:m,onThumbUpClick:g,onThumbDownClick:h,patchUrl:p,chatSessionId:f}):a().createElement(E,{setState:T,createChatBotMessage:i},a().createElement(k,null,a().createElement(j,{state:P,setState:T,widgetRegistry:S,actionProvider:E,messageParser:k,customMessages:B,customComponents:F({},I),botName:N,customStyles:F({},x),headerText:o,placeholderText:s,setMessageContainerRef:O,validator:d,messageHistory:l,disableScrollToBottom:m,onThumbUpClick:g,onThumbDownClick:h,patchUrl:p,chatSessionId:f})))},V=q;module.exports=t})();